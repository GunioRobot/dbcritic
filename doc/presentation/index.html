<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>DBIx::Class::Schema::Critic</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="pod2s5 0.08" />
<meta name="generator" content="S5" />
<meta name="version" content="S5 1.1" />
<meta name="presdate" content="September 12, 2011" />
<meta name="author" content="Mark Gardner" />
<meta name="company" content="&nbsp;" />
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<link rel="stylesheet" href="ui/default/slides.css" type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/default/outline.css" type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/default/print.css" type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/default/opera.css" type="text/css" media="projection" id="operaFix" />

<!-- embedded styles -->
<style type="text/css" media="all">
.imgcon {width: 525px; margin: 0 auto; padding: 0; text-align: center;}
#anim {width: 270px; height: 320px; position: relative; margin-top: 0.5em;}
#anim img {position: absolute; top: 42px; left: 24px;}
img#me01 {top: 0; left: 0;}
img#me02 {left: 23px;}
img#me04 {top: 44px;}
img#me05 {top: 43px;left: 36px;}
</style>
<!-- S5 JS -->
<script src="ui/default/slides.js" type="text/javascript"></script>
<!--
   tom AT cpan.org:
   this will not work, it's not contained
   in the downloadable S5
   <script src="/mint/?js" type="text/javascript"></script></head>
-->
<body>

<div class="layout">

<div id="controls"></div>
<div id="currentSlide"></div>
<div id="header"></div>
<div id="footer">
<h1>Philadelphia, PA &#8226; September 12, 2011</h1>
<h2>DBIx::Class::Schema::Critic</h2></div>
</div><div class="slide">
<h1>DBIx::Class::Schema::Critic

</h1><p>Mark Gardner <i><<a href="mailto:mjgardner@cpan.org">mjgardner@cpan.org</a>></i>

</p><p><img src="The-Critic.jpg" />


</p></div>
<div class="slide">
<h1>I love Perl::Critic

</h1><ul class="incremental"><li level="1"><p>makes sure I follow the same coding standards

</p></li><li level="1"><p>catches potential maintenance problems and ambiguities

</p></li><li level="1"><p>adjustable so I can bend the "rules" when I need to

</p></li></ul class="incremental"></div>
<div class="slide">
<h1>I hate databases

</h1><p><i>(specifically, relational database schemas)</i>

</p><ul class="incremental"><li level="1"><p>a lot of details to get right when developing a schema

</p></li><li level="1"><p>a lot of repetitive SQL to keep consistent

</p></li><li level="1"><p>often thrown together by developers (like me) more focused on code

</p></li></ul class="incremental"></div>
<div class="slide">
<h1>Quick Demo

</h1>$&nbsp;sqlite3&nbsp;sample/demo.db&nbsp;.schema<BR>
<BR>
<pre>CREATE TABLE person (name, title); </pre>$&nbsp;dbic_critic&nbsp;--dsn&nbsp;dbi:SQLite:sample/demo.db<BR>
<BR>
</div>
<div class="slide">
<h1>Quick Demo Results

</h1>$&nbsp;dbic_critic&nbsp;--dsn&nbsp;dbi:SQLite:sample/demo.db<BR>
<BR>
<pre>[Table person] No primary key
Tables should have one or more columns defined as a primary key.
person has no primary key </pre><p><img src="Critic-Main-600x314.jpg" />



</p></div>
<div class="slide">
<h1>What just happened?

</h1><ul class="incremental"><li level="1"><p>Connect to database

</p></li><li level="1"><p>Turn database schema into Perl classes

</p></li><li level="1"><p>Load plugins to process each type of class created

</p></li><li level="1"><p>Loop over the classes, plugins report violations of a policy

</p></li><li level="1"><p>(structure borrowed from Perl::Critic's processing of Perl documents)

</p></li></ul class="incremental"></div>
<div class="slide">
<h1>I Love CPAN

</h1><ul><li level="1"><code>DBIx::Class</code>

</li><li level="1"><code>DBIx::Class::Schema::Loader</code>

</li><li level="1"><code>Module::Pluggable</code>

</li><li level="1"><code>Moo</code>

</li></ul></div>
<div class="slide">
<h1>Under the hood

</h1><h2>Main classes

</h2><ul><li level="1"><code>Critic</code>

</li><li level="1"><code>Critic::Loader</code>

</li><li level="1"><code>Critic::Violation</code>

</li></ul><h2>Roles

</h2><ul><li level="1"><code>Critic::Policy</code>

</li><li level="1"><code>Critic::PolicyType</code>

</li></ul><p><i>(all under <code>DBIx::Class::Schema::</code>)</i>

</p></div>
<div class="slide">
<h1>What is a policy?

</h1><ul><li level="1">concept borrowed from Perl::Critic

</li><li level="1">in <code>DBIx::Class::Schema::Critic::Policy::</code> namespace

</li><li level="1">has four methods

<ul><li level="1"><code>description</code>:
returns a plain string

</li><li level="1"><code>explanation</code>:
returns a plain string

</li><li level="1"><code>applies_to</code>:
returns a reference to a list of things the policy criticizes

</li><li level="1"><code>violates</code>:
returns a Violation object if the policy was violated

</li></ul></li><li level="1">That's it.

</li></ul></div>
<div class="slide">
<h1>What Is A Violation?

</h1><ul><li level="1">concept borrowed from Perl::Critic

</li><li level="1">instance of <code>DBIx::Class::Schema::Critic::Violation</code>

</li><li level="1">has <code>description</code>, <code>explanation</code> and <code>element</code> attributes from a violated Policy

</li><li level="1">has a <code>details</code> attribute for the specific issue found

</li><li level="1">stringifies for Critic reports


</div>
<div class="slide">
<h1>Moo and Roles make it easier

</h1><b>use</b>&nbsp;Moo;<BR>
<b>sub&nbsp;</b><font color="#007f00">description</font>&nbsp;{<font color="#ffa500">'</font><font color="#ff0000">Follow&nbsp;my&nbsp;policy</font><font color="#ffa500">'</font>}<BR>
<b>sub&nbsp;</b><font color="#007f00">explanation</font>&nbsp;{<font color="#ffa500">'</font><font color="#ff0000">My&nbsp;way&nbsp;or&nbsp;the&nbsp;highway!</font><font color="#ffa500">'</font>}<BR>
<b>sub&nbsp;</b><font color="#007f00">violates</font>&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<b>my</b>&nbsp;<font color="#0000ff">$self</font>&nbsp;=&nbsp;<font color="#007f00">shift</font>;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<b>my</b>&nbsp;<font color="#0000ff">$schema</font>&nbsp;=&nbsp;<font color="#0000ff">$self</font>-&gt;<font color="#0000ff">schema</font>;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<b>my</b>&nbsp;<font color="#0000ff">$element</font>&nbsp;=&nbsp;<font color="#0000ff">$self</font>-&gt;<font color="#0000ff">element</font>;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<b>return</b>&nbsp;<font color="#ffa500">'</font><font color="#ff0000">This&nbsp;policy&nbsp;always&nbsp;fails</font><font color="#ffa500">'</font>;&nbsp;<font color="#7f7f7f"><i>#&nbsp;becomes&nbsp;details&nbsp;of&nbsp;the&nbsp;Violation</i></font><font color="#7f7f7f"><i><BR>
</i></font>}<BR>
<font color="#7f7f7f"><i>#&nbsp;take&nbsp;care&nbsp;of&nbsp;applies_to&nbsp;and&nbsp;returning&nbsp;a&nbsp;Violation&nbsp;object</i></font><font color="#7f7f7f"><i><BR>
</i></font>with&nbsp;<font color="#ffa500">'</font><font color="#ff0000">DBIx::Class::Schema::Critic::PolicyType::ResultSource</font><font color="#ffa500">'</font>;<BR>
<BR>
</div>
<div class="slide">
<h1>TODO

</h1><ul class="incremental"><li level="1"><p>Steal more ideas from Perl::Critic!

</p><ul><li level="1">Configure which policies run, severity levels, themes, etc.

</li><li level="1">Support configurable policies

</li></ul></li><li level="1"><p>Make installable outside of CPAN toolchain for non-Perl programmers.

</p><p>(I'm sure Ruby and PHP people have crappy databases too.)

</p></li><li level="1"><p>MOAR POLICIES

</p><p>(Have ideas? Pls submit on <a href="http://github.com/mjgardner/DBIx-Class-Schema-Critic/issues">GitHub</a> KTHX)

</p></li></ul class="incremental"></div>
<div class="slide">
<h1>Where To Get it

</h1><ul><li level="1">Download

<ul><li level="1">CPAN: <a href="http://search.cpan.org/dist/DBIx-Class-Schema-Critic/">http://search.cpan.org/dist/DBIx-Class-Schema-Critic/</a>

</li><li level="1">MetaCPAN: <a href="http://metacpan.org/release/DBIx-Class-Schema-Critic/">http://metacpan.org/release/DBIx-Class-Schema-Critic/</a>

</li></ul></li><li level="1">Contribute ideas, policies and code

<ul><li level="1">GitHub: <a href="http://github.com/mjgardner/DBIx-Class-Schema-Critic">http://github.com/mjgardner/DBIx-Class-Schema-Critic</a>

</li><li level="1">I use Dist::Zilla, but the default branch doesn't need it.

</li></ul></li></ul><ul class="incremental"><li level="1"><p>Questions?

</p></li></ul class="incremental"></li></ul></div></body></html>